# ── Core (works out of the box for local dev) ──────────────────────
DATABASE_URL=postgresql+psycopg://openar:openar_dev@localhost:5433/openar
JWT_SECRET_KEY=local-dev-jwt-secret-do-not-use-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TTL_MIN=15

BETTER_AUTH_BASE_URL=http://localhost:3001
BETTER_AUTH_BASE_PATH=/api/auth
AUTH_REQUEST_TIMEOUT_SEC=10

# Streaming orchestrator
MAX_WORKERS=4
DEFAULT_STREAM_ID=default
# Keep a stream alive this many seconds after last heartbeat (0 disables heartbeat-idle stop).
STREAM_IDLE_TIMEOUT_SECONDS=300
# Stop worker when no active detections websocket viewers for this many seconds.
STREAM_NO_VIEWER_TIMEOUT_SECONDS=15
# If true, DEFAULT_STREAM_ID ignores no-viewer stop.
PROTECT_DEFAULT_STREAM=false
STREAM_READ_FPS_CAP=0
STREAM_DETECTION_QUEUE_SIZE=4

# MediaMTX / FFmpeg publishing
MEDIAMTX_ENABLED=true
MEDIAMTX_RTSP_BASE=rtsp://localhost:8554
MEDIAMTX_WHEP_BASE=http://localhost:8889
MEDIAMTX_HLS_BASE=http://localhost:8888
# Optional publish credentials for MediaMTX auth hook
MEDIAMTX_PUBLISH_USER=
MEDIAMTX_PUBLISH_PASS=
# Optional read credentials (not included in playback URLs unless explicitly enabled)
MEDIAMTX_READ_USER=
MEDIAMTX_READ_PASS=
MEDIAMTX_INCLUDE_READ_CREDENTIALS_IN_URLS=false

# FFmpeg encoder controls for RTSP publish
FFMPEG_BIN=ffmpeg
# libx264 (CPU), h264_videotoolbox (Apple Silicon/macOS), h264_nvenc (NVIDIA)
FFMPEG_CODEC=libx264
FFMPEG_LIBX264_PRESET=ultrafast
FFMPEG_NVENC_PRESET=p1
FFMPEG_VIDEO_BITRATE=4M
FFMPEG_GOP=30
# Optional downscale before encoding (0 disables scaling)
FFMPEG_SCALE_WIDTH=0
FFMPEG_SCALE_HEIGHT=0

# Optional extra frontend origins for CORS (comma-separated)
# Example: FRONTEND_ORIGINS=http://10.0.0.3:5173,http://10.0.0.4:5173
FRONTEND_ORIGINS=
# Redis pub/sub for detection streaming
REDIS_URL=redis://localhost:6379/0
REDIS_DETECTIONS_CHANNEL_PREFIX=detections
DEFAULT_DETECTIONS_STREAM_ID=default

CORS_ORIGINS=http://localhost:5173,http://localhost:3000,http://127.0.0.1:5173,http://127.0.0.1:3000

# ── Optional (features degrade gracefully without these) ──────────
# RT-DETR model — defaults to rtdetr-l.pt if omitted
# DETECTOR_MODEL=rtdetr-l.pt
# DETECTOR_CONFIDENCE=0.25

# S3 storage — upload/download features disabled without these
# S3_ACCESS_KEY=
# S3_SECRET_KEY=
# S3_PUBLIC_BASE_URL=
# S3_PRESIGN_EXPIRES=900

# AIS vessel data — AIS overlay disabled without these
# Get credentials: https://www.barentswatch.no/minside/devaccess/ais
# AIS_CLIENT_ID=
# AIS_CLIENT_SECRET=
